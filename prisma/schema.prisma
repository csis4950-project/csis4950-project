// * after create schemas, run `npx prisma migrate dev --name init`;
// * above code runs `npx prisma generate` under the hood by default;
// ! .env file should belong to root directory
// * When the command does not work, check the privious migration file and directry change;

// * commend for updating schema: npx prisma db push

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "cockroachdb"
  url      = env("DATABASE_URL")
}

model User {
  id          String @id @default(uuid())
  firstName   String @db.String(25)
  lastName    String @db.String(25)
  email       String @unique
  password    String @db.String(60)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deletedAt   DateTime?

  // relations
  ownerId Organization[] @relation("ownerId")
  memberId DepartmentMember[] @relation("memberId")
}

model Organization {
  id        String @id @default(uuid())
  ownerId   String
  name      String @db.String(25)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime?

  // relations
  owner User @relation("ownerId", fields: [ownerId], references: [id])
  organizationId Department[] @relation("organizationId")
}

model Department {
  id             String @id @default(uuid())
  organizationId String
  name           String @db.String(25)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  deletedAt      DateTime?

  // relations
  organization Organization @relation("organizationId", fields: [organizationId], references: [id])
  departmentId DepartmentMember[] @relation("departmentId")
}

model Role {
  id          String @id @default(uuid())
  name        String @unique @db.String(25)
  description String @db.String(150)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deletedAt   DateTime?

  // relations
  roleId DepartmentMember[] @relation("roleId")
}

model DepartmentMember {
  id           String @id @default(uuid())
  departmentId String
  memberId     String
  roleId       String

  //relations
  department Department @relation("departmentId", fields: [departmentId], references: [id])
  member User @relation("memberId", fields: [memberId], references: [id])
  role Role @relation("roleId", fields: [roleId], references: [id])
}

model Request {
  id String @id @default(uuid())
  detail String @db.String(50)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deletedAt   DateTime?

  // relations
  // userId
  // tagId[]
  // statusId

}

model Schedule {
  id String @id @default(uuid())
  date DateTime
  startTime DateTime
  endTime DateTime
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deletedAt   DateTime?

  // relations
  // useId
}

model WorkTime {
  id String @id @default(uuid())
  date DateTime
  hoursWorked Int

  // relations
  // userId

}

model Availability {
  id String @id @default(uuid())
  date DateTime
  day DateTime
  time DateTime

  // relations
  // userId
}

model Announcement {
  id String @id @default(uuid())
  title String @db.String(25)
  detail String @db.String(100)

  // relations
  // userId
  // tagId[]


}

model Tag {
  id String @id @default(uuid())
  name String @db.String(25)
  description String @db.String(50)
}